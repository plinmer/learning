参考文档：https://www.xiaolincoding.com/mysql/log/how_update.html

# MySQL执行一条查询语句，底层是怎么工作的？
![MySQL执行器](images/mysql查询流程.webp)

# MySQL的内存结构
![MySQL内存结构](images/mysql内存结构.png)


# undo log、redo log、binlog 有什么用？
WAL技术：Write-Ahead Logging，表示异步就行数据更新刷盘；
Redolog能力：
1、数据的修改记录，在数据重启后能进行恢复 crash-safe能力；
2、将写操作从「随机写」变成了「顺序写」
Undolog：
undolog版本链，进行MVCC控制使用；
redolog什么时候刷盘：
redolog的刷盘分为三步，写redolog-buffer，PageCache，磁盘；因此对应3中策略；
Redolog写满了怎么办：
redolog是一个环形的缓冲区，当写满后，就回触发buffer的脏页写入到磁盘，然后刷新redolog-buffer；
biglog与redolog的区别：
1、使用对象不同：biglog主从同步使用的，Server写的日志；redolog：crash-safe恢复用的，存储引擎写的日志；
2、文件格式不同：binlog有3种模式：STATEMENT（默认格式）、ROW、 MIXED；redolog只有一中；
3、写入方式不同：binlog是追加写，redolog是循环写；
binlog如何刷盘：三种时机；
两阶段提交

prepare阶段：redolog的准备阶段；
commit阶段：写入binlog，redolog的阶段更新为commit；
有什么问题？
多事务下，两阶段必须要保证事务提交的顺序性；因为回滚的时候事务的先后顺序是很关键的；
MySQL 的IO很高，有什么优化的地方？
1、PageCache命中率低？加大buffer-pool内存大小，增加缓存命中率；
2、binlog刷盘多？调整提交时机
3、redolog刷盘多？调整提交时机
主从同步，如何同步，数据一致性问题，数据时延问题
主从同步：binlog

数据时延：同步复制，异步复制，半同步复制


 

